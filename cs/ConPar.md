### **동시성(Concurrency) vs 병렬성(Parallelism)**

- 자바스크립트에서 싱글스레드 언어라고 하는데 그게 뭘까?
- 동시성이라는 말도 이벤트 루프과정에서 많이 들어봤는데 동시성은 뭘까?

### **프로세스, 스레드, 프로그램**

- `프로세스` : 운영체제로부터 자원을 할당받았을 때 작업의 단위.
- `스레드` : 프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위.
- `프로그램` : 파일이 저장 장치에 저장되어 있지만 `메모리에는 올라가 있지 않은` 정적인 상태
  - `메모리에 올라가 있지 않은` : 아직 운영체제가 프로그램에게 독립적인 `메모리 공간`을 `할당해주지 않았다`는 뜻
  - 모든 프로그램은 운영체제가 실행되기 위한 메모리 공간을 할당해 줘야 실행될 수 있다.
  - 정적인 상태 : 실행되지 않고 가만히 있다는 뜻

> 프로세스 : 실행되고 있는 컴퓨터 프로그램

### **프로세스, 스레드**

#### **스레드의 등장**

- 과거에는 프로그램을 실행할 때 실행 시작부터 실행 끝까지 프로세스 하나만을 사용해서 진행 했지만 점차 규모가 커지면서 프로세스 하나만을 사용해서 프로그램을 실행하기는 벅차게 되었다.
- 프로세스와는 다른 더 작은 실행 단위 개념이 필요하게 되었고, 이 개념이 바로 스레드

### **프로세스와 스레드의 차이**

- 프로그램이 실행될때 운영체제로부터 자원을 할당받는다. 이 때 운영체제는 프로세스마다 각각 독립된 메모리 영역 (`Code` / `Data` / `Stack` / `Heap`) 4가지 형식으로 할당
  <img src ="https://cs.carleton.edu/faculty/awb/cs332/s20/topics/images/process-addr-space.png">

- 프로세스는 각각 독립된 메모리 영역을 할당해 주기 때문에 프로세스는 다른 프로세스의 변수나 자료에 접근할 수 없다.

- 프로세스가 강제로 종료된다면, 다른 프로세스에게 어떤 영향이 있을까? 공유하고 있는 파일을 손상시키는 경우가 아니라면 아무런 영향

- 스레드의 경우는 다르다. 스레드는 `Code`/`Data`/`Heap` 메모리 영역의 내용을 공유하기 때문에 어떤 스레드 하나에서 오류가 발생한다면 같은 프로세스 내의 다른 스레드 모두가 강제로 종료
  <img src = "https://t1.daumcdn.net/cfile/tistory/999A6E375B8D2F0B37">

- 스레드의 경우 CPU 관점에서의 최소 작업 단위가 된다.
- 운영체제는 이렇게 작은 단위까지 직접 작업하지 않기 때문에 운영체제 관점에서는 프로세스가 최소 작업 단위

- 멀티태스킹 : 하나의 운영체제 안에서 여러 프로세스가 실행되는 것을 의미
- 멀티스레드 : 하나의 프로세스가 여러 작업을 여러 스레드를 사용하여 동시에 처리
- 여러 스레드가 함께 전역 변수를 사용할 경우 발생할 수 있는 충돌이 발생 할 수 있음

### **프로세스가 다른 프로세스의 정보에 접근하는 방법**

- IPC(Inter-Process Communication)을 사용

- LPC(Local inter-Process Communication)을 사용

- 별도로 공유 메모리를 만들어서 정보를 주고받도록 설정

### **싱글스레드와 멀티스레드**

<img src="https://velog.velcdn.com/images%2Feunjin%2Fpost%2Fc63d6950-7ae7-439a-9ee8-d6f145d6808a%2FScreen%20Shot%202021-01-17%20at%204.18.53%20PM.png">

### **싱글스레드의 특징**

- 공용 자원에 대한 접근에 대한 처리에서 이점
- 여러 개의 CPU를 활용하지 못한다.
- 두 개의 작업을 하나의 스레드로 처리하는 경우, 두 개의 스레드로 처리하는 경우를 가정했을 때, 후자의 경우는 짧은 시간 동안 두개의 스레드가 번갈아가면서 작업을 수행한다. 그래서 동시에 두 작업이 처리되는 것과 같이 느끼게 된다.
- 하지만 두 개의 스레드로 작업한 시간이 싱글스레드로 작업한 시간보다 더 걸릴 수도 있는데, 그 이유는 스레드 간의 작업전환(context switching)때문임.

### **멀티스레드의 특징**

- 프로세스 내에서 자원을 공유하여 자원 생성과 관리의 중복을 최소화
- 서버가 많은 요청을 효율적으로 수행할 수 있는 환경을 제공
- 각각의 스레드가 고유의 레지스터와 스택으로 표현됨.

### **동시성과 병렬성**

- 동시성
- 동시에 실행되는 것 같이 보이는 것
- 싱글 코어에서 멀티 쓰레드(Multi thread)를 동작 시키는 방식

- 병렬성
- 실제로 동시에 여러 작업이 처리되는 것
- 멀티 코어에서 멀티 쓰레드(Multi thread)를 동작시키는 방식

  <img src = "https://t1.daumcdn.net/cfile/tistory/99AD02405FBBB94910"/>
  <img src = "https://t1.daumcdn.net/cfile/tistory/995359405FBBB9591C"/>

- 하나의 커피머신이 있는데 커피를 받기 위한 사람들의 줄이 2줄로 되어 있습니다. 그래서 서로 번갈아가면서 커피를 타게 되었을 때 이러한 것을 동시성 처리
- 2개의 커피 머신이 있고 각 커피 머신마다 하나의 줄을 가지고 있어서 각각의 줄마다 커피를 받을 수 있는 것을 병렬 처리

### **contextSwitching**

- Context Switching 이란 CPU가 한 개의 Task를 실행하고 있는 상태에서 다른 Task 로 실행이 전환될 때 기존의 Task 상태 및 Register 값들에 대한 정보(Context)를 저장하고 새로운 Task 의 Context 정보로 교체하는 작업

### **MultiProcess vs MultiThread in cost**

- 멀티 프로세스의 컨텍스트 스위칭

  - 캐싱의 효율이 급감함
  - 가상 메모리 공간이 유지되지 않기 때문에, 운영체제에서 메모리 입출력(할당)이 필요

- 멀티 스레드의 컨텍스트 스위칭

  - 캐싱 효율 좋음
  - 가상 메모리 공간이 유지되기 때문에, 스레드 간 컨텍스트만 교환
